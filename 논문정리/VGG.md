# VGG

VGGNet은 옥스포드 대학의 연구팀 VGG에 의해 개발된 모델로써, 2014년 이미지넷 이미지 인식 대회에서 준우승을 한 모델이다. 여기서 말하는 VGGNet은 16개 또는 19개의 층으로 구성된 모델을 의미한다.(VGG16, VGG19로 불림)

역사적으로 봤을 때 VGGNet 모델부터 시작해서 네트워크의 깊이가 확 깊어졌다. 아래 그림을 참고하자.

<img width="603" alt="스크린샷 2020-12-17 오전 9 22 37" src="https://user-images.githubusercontent.com/69491771/102422144-74b8f200-4049-11eb-9e50-5543f5d169b3.png"> 

2012년, 2013년 우승 모델들은 8개의 층으로 구성되었다. 반면 2014년의 VGGNet(VGG19)는 19층으로 구성되었고, 또한 GoogLeNet은 22층으로 구성되었다. 그리고 2015년에 이르러서 152개의 층으로 구성된 ResNet이 제안 되었다. 네트워크가 깊어질수록 성능이 좋아졌음을 위 그림을 통해 확인할 수 있다. VGGNet은 사용하기 쉬운 구조와 좋은 성능 덕분에 그 대회에서 우승을 거둔 Google보다 더 인기를 얻었다.

## VGGNet 의 구조

VGGNet의 논문의 개요에서 밝히고 있듯이 이 연구의 핵심은 네트워크의 깊이를 깊게 만드는 것이 성능에 어떤영향을 미치는지를 확인하고자 한것이다. VGG 연구팀은 깊이의 영향만을 최대한 확인하고자 컨볼루션 필터의 사이즈는 가장 작은 3x3으로 고정했다.

VGG 연구팀은 논문에서 총 6개의 구조(A, A-LRN, B, C, D, E)를 만들어 성능을 비교했다. 여러구조를 만든 이유는 기본적으로 깊이 따른 성능 변화를 비교하기 위함이다. 이중 D 구조가 VGG16이고 E 구조가 VGG19라고 보면 된다.

<img width="551" alt="스크린샷 2020-12-17 오전 9 32 10" src="https://user-images.githubusercontent.com/69491771/102422735-c2822a00-404a-11eb-86d7-9702eabda597.png"> 

VGG 연구팀은 AlexNet과 VGG-F, VGG-M, VGG-S에서 사용되던 Local Response Normalization(LRN)이 A 구조와 A-LRN 구조의 성능을 비교함으로 성능 향상에 별로 효과가 없다고 실험을 통해 확인했다. 그래서 더 깊은 B, C, D, E 구조에는 LRN을 적용하지 않는다고 논문에서 밝혔다. 또한 그들은 깊이가 11층, 13층, 16층, 19층으로 깊어지면서 분류 에러가 감소하는 것을 관찰했다. 즉, 깊어질수록 성능이 좋아진다는 것이었다.

VGGNet의 구조를 깊이 들여다보기에 앞서 먼저 집고 넘어가야할 내용이 있다. 그것은 3x3 필터로 두차례 컨볼루션을 하는 것과 5x5 필터로 한번 컨볼루션을 하는 것이 결과적으로 동일한 사이즈의 특성맵을 산출한다는 것이다. 3x3 필터로 세차례 컨볼루션 하는것은 7x7 필터로 한번 컨볼루션 하는 것과 대응된다.

<img width="646" alt="스크린샷 2020-12-17 오전 9 40 14" src="https://user-images.githubusercontent.com/69491771/102423229-e4c87780-404b-11eb-982f-975d9da309d4.png"> 

그러면 3x3 필터로 세차례 컨볼루션을 하는 것이 7x7 필터로 한번 컨볼루션하는 것보다 나은 점은 무엇일까? 일단 가중치 또는 파라미터의 개수의 차이다. 3x3 필터가 3개면  총 27개의 가중치를 갖는다. 반면 7x7 필터는 49개의 가중치를 갖는다. CNN에서 가중치는 모두 훈련이 필요한 것들이므로, 가중치가 적다는 것은 그만큼 훈련시켜야할 개수가 작아진다. 따라서 학습의 속도가 빨라진다. 동시에 층의 개수가 늘어나면서 특성에 비선형성을 더 증가시키기 때문에 특성이 점점 더 유용해진다.

## VGG16 구조 분석

VGG16를 에시로, 각 층마다 어떻게 특성맵이 생성되고 변화되는지 자세하게 살펴보자. 아래 구조도와 함께 각 층의 세부사항을 읽어나면 이해하기가 그렇게 어렵지 않을 것이다.

<img width="710" alt="스크린샷 2020-12-17 오전 9 50 30" src="https://user-images.githubusercontent.com/69491771/102423877-535a0500-404d-11eb-98a4-184b206f2102.png"> 

